# #######################################################################################
# █ █ █▄█ █▀█ █▀█ █   ▄▀█ █▄ █ █▀▄   █▀▀ █▀█ █▄ █ █▀▀ █▀▀
# █▀█  █  █▀▀ █▀▄ █▄▄ █▀█ █ ▀█ █▄▀   █▄▄ █▄█ █ ▀█ █▀  █▄█
# #######################################################################################

# --- ОСНОВНЫЕ ПЕРЕМЕННЫЕ ОКРУЖЕНИЯ ---

# Запуск графического агента аутентификации (окна подтверждения пароля)
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1
# Отключение специфических порталов libadwaita для лучшей совместимости тем
env = ADW_DISABLE_PORTAL,1
# Настройка монитора: авто-определение, лучшее разрешение, позиция авто, масштаб 1
monitor=,preferred,auto,1.0
# Запуск демона для текста
exec-once = wl-paste --type text --watch cliphist store 
# Запуск демона для изображений (если нужно сохранять и их)
exec-once = wl-paste --type image --watch cliphist store



# Автозапуск v2rayA: выбор лучшего сервера и старт
exec-once = sleep 5 && curl -X POST "http://127.0.0.1:2017/api/v2raya/sub/update" && curl -X POST "http://127.0.0.1:2017/api/v2raya/switch?action=start&fastest=true"


# --- ПРОГРАММЫ (ПЕРЕМЕННЫЕ) ---

# Терминал по умолчанию
$terminal = kitty
# Браузер по умолчанию
$browser = firefox
# Файловый менеджер
$fileManager = nautilus
# Меню запуска приложений с иконками и кастомным конфигом rofi
$menu = rofi -show drun -modi drun -show-icons -config ~/.config/rofi/config.rasi




# --- СИСТЕМНЫЙ АВТОЗАПУСК ---

# Передача переменных окружения в systemd для работы Wayland
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
# Запуск верхней панели
exec-once = waybar
# Запуск центра уведомлений
exec-once = swaync
# Служба сохранения текстовой истории буфера обмена
exec-once = wl-paste --type text --watch cliphist store
# Служба сохранения изображений из буфера обмена
exec-once = wl-paste --type image --watch cliphist store
# Запуск мессенджера Telegram при входе
# exec-once = materialgram
# Индикатор сетевого подключения в трее
exec-once = nm-applet
# Графический планшет
exec-once = dexptablet
# обои
exec-once = swaybg -i ~/Pictures/swww/01.jpg -m fill
# --- ТЕМАТИЗАЦИЯ (GTK & QT) ---

exec-once = gsettings set org.gnome.desktop.interface gtk-theme 'Arc-Dark'
exec-once = gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'



# --- ВНЕШНИЙ ВИД (GENERAL) ---

general {
    # Внутренние отступы (между окнами)
    gaps_in = 6
    # Внешние отступы (между окном и краем монитора)
    gaps_out = 8
    # Толщина рамки окна
    border_size = 3
    # Цвет рамки активного окна (голубой)
    col.active_border = rgb(88B7FF)
    # Цвет рамки неактивного окна (темно-серый)
    col.inactive_border = rgb(2a2d31)
    # Алгоритм расположения окон (dwindle — "закручивание")
    layout = dwindle
}




# --- ДЕКОРАЦИИ И ЭФФЕКТЫ ---

decoration {
    # Скругление углов окон
    rounding = 10
    # Прозрачность активного окна 
    active_opacity = 0.85
    # Прозрачность неактивных окон
    inactive_opacity = 0.75
    
    blur {
        # Включение размытия под прозрачными окнами
        enabled = true
        # Интенсивность размытия
        size = 8
        # Количество проходов размытия (влияет на качество и нагрузку)
        passes = 2
        # Размывать фон, игнорируя настройки прозрачности самого окна
        ignore_opacity = true
    }

    shadow {
        # Включение теней у окон
        enabled = true
        # Радиус тени
        range = 4
        # Цвет и прозрачность тени (черный с прозрачностью ee)
        color = rgba(1a1a1aee)
    }
}




# --- НАСТРОЙКИ ВВОДА ---

input {
    # Раскладки клавиатуры: Английская и Русская
    kb_layout = us,ru
    # Переключение раскладки комбинацией Alt+Shift
    kb_options = grp:alt_shift_toggle
    # Скорость повтора зажатой клавиши
    repeat_rate = 30
    # Задержка перед началом повтора клавиши
    repeat_delay = 300
    # Фокус окна переключается при наведении курсора мыши
    follow_mouse = 1
    # Чувствительность мыши (ускорение)
    sensitivity = 0.3
    
    touchpad {
        # Естественная прокрутка (инверсия скролла)
        natural_scroll = true
        # Нажатие на тачпад эмулирует клик мыши
        tap-to-click = true
    }
}

# Настройка жестов (свайп 3 пальцами горизонтально меняет рабочий стол)
gesture = 3, horizontal, workspace




# --- ГОРЯЧИЕ КЛАВИШИ  ---

# Определение основной модифицирующей клавиши 
$mainMod = SUPER

# Запуск терминала (Super + Enter)
bind = $mainMod, RETURN, exec, $terminal
# Открыть меню приложений (Super + Shift + W)
bind = $mainMod SHIFT, W, exec, $menu
# Открыть проводник (Super + Shift + E)
bind = $mainMod SHIFT, E, exec, $fileManager
# Открыть браузер (Super + Shift + B)
bind = $mainMod SHIFT, B, exec, $browser
# Запустить Telegram (Super + Shift + T)
bind = $mainMod SHIFT, T, exec, materialgram
# Запустить Obsidian (Super + Shift + O)
bind = $mainMod SHIFT, O, exec, obsidian
# Запустить Rnote (Super + Shift + R)
bind = $mainMod SHIFT, R, exec, rnote
# Запустить музыкальный плеер G4Music (Super + Shift + M)
bind = $mainMod SHIFT, M, exec, g4music
# Заблокировать экран (Super + L)
bind = $mainMod SHIFT, L, exec, hyprlock
#Frog
bind = $mainMod SHIFT, F, exec, flatpak run com.github.tenderowl.frog
# Бургер обмена
bind = SUPER, V, exec, cliphist list | rofi -dmenu | cliphist decode | wl-copy && wtype -M ctrl v -m ctrl

# УПРАВЛЕНИЕ ОКНАМИ
# Закрыть текущее окно (Super + Q)
bind = $mainMod, Q, killactive
# Сделать окно плавающим (Super + Shift + Space)
bind = $mainMod, SPACE, togglefloating
# Развернуть окно на весь экран (Super + F)
bind = $mainMod, F, fullscreen

# ФОКУС (Vim-навигация HJKL)
# Фокус влево
bind = $mainMod, H, movefocus, l
# Фокус вправо
bind = $mainMod, L, movefocus, r
# Фокус вверх
bind = $mainMod, K, movefocus, u
# Фокус вниз
bind = $mainMod, J, movefocus, d


# РАБОЧИЕ СТОЛЫ 
# Переход на стол 1
bind = $mainMod, 1, workspace, 1
# Переход на стол 2
bind = $mainMod, 2, workspace, 2
# Переход на стол 3
bind = $mainMod, 3, workspace, 3
# Переход на стол 4
bind = $mainMod, 4, workspace, 4
# Переход на стол 5
bind = $mainMod, 5, workspace, 5
# Переход на стол 6
bind = $mainMod, 6, workspace, 6
# Переход на стол 7
bind = $mainMod, 7, workspace, 7
# Переход на стол 8
bind = $mainMod, 8, workspace, 8
# Переход на стол 9
bind = $mainMod, 9, workspace, 9
# Переход на стол 10
bind = $mainMod, 0, workspace, 10

# ПЕРЕНОС ОКОН НА ВОРКСПЕЙСЫ
# Переместить окно на стол 1
bind = $mainMod SHIFT, 1, movetoworkspace, 1
# Переместить окно на стол 2
bind = $mainMod SHIFT, 2, movetoworkspace, 2
# Переместить окно на стол 3
bind = $mainMod SHIFT, 3, movetoworkspace, 3
# Переместить окно на стол 4
bind = $mainMod SHIFT, 4, movetoworkspace, 4
# Переместить окно на стол 5
bind = $mainMod SHIFT, 5, movetoworkspace, 5
# Переместить окно на стол 6
bind = $mainMod SHIFT, 6, movetoworkspace, 6
# Переместить окно на стол 7
bind = $mainMod SHIFT, 7, movetoworkspace, 7
# Переместить окно на стол 8
bind = $mainMod SHIFT, 8, movetoworkspace, 8
# Переместить окно на стол 9
bind = $mainMod SHIFT, 9, movetoworkspace, 9
# Переместить окно на стол 10
bind = $mainMod SHIFT, 0, movetoworkspace, 10

# СКРИНШОТЫ
# Скриншот области экрана с сохранением в папку и копированием в буфер обмена
bind = , Print, exec, grim -g "$(slurp)" ~/Pictures/screenshot/$(date +'%Y-%m-%d_%H-%M-%S').png && wl-copy < ~/Pictures/screenshot/$(ls -t ~/Pictures/screenshot | head -n1)
# Скриншот всего экрана с сохранением и копированием
bind = SHIFT, Print, exec, grim ~/Pictures/screenshot/$(date +'%Y-%m-%d_%H-%M-%S').png && wl-copy < ~/Pictures/screenshot/$(ls -t ~/Pictures/screenshot | head -n1)

# ВЫХОД ИЗ СИСТЕМЫ
# Выход из Hyprland
bind = $mainMod SHIFT, Backspace, exit

# МЫШЬ 
# Перемещение окна зажатием Super + Левая Кнопка Мыши
bindm = $mainMod, mouse:272, movewindow
# Изменение размера окна зажатием Super + Правая Кнопка Мыши
bindm = $mainMod, mouse:273, resizewindow

# МУЛЬТИМЕДИА КЛАВИШИ
# Увеличить громкость на 5% через wpctl
bindel = ,XF86AudioRaiseVolume, exec, wpctl set-volume -l 1 @DEFAULT_AUDIO_SINK@ 5%+
# Уменьшить громкость на 5%
bindel = ,XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
# Включить/Выключить звук (Mute)
bindel = ,XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
# Включить/Выключить микрофон
bindel = ,XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
# Увеличить яркость экрана на 5% через brightnessctl
bindel = ,XF86MonBrightnessUp, exec, brightnessctl set 5%+
# Уменьшить яркость экрана на 5%
bindel = ,XF86MonBrightnessDown, exec, brightnessctl set 5%-


misc {
    # Отключает стандартные обои Hyprland
    disable_hyprland_logo = true
    force_default_wallpaper = 0
}



# Запуск трея (nm-applet) для иконки Wi-Fi
exec-once = nm-applet --indicator &

